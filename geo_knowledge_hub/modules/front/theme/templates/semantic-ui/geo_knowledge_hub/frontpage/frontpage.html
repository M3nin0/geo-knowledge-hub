{%- extends "invenio_app_rdm/frontpage.html" %}

{%- block css %}
  {{ super() }}
  {{ webpack["geo-knowledge-hub-front-carousel-theme.css"] }}

  <link
    rel="stylesheet"
    href="https://unpkg.com/swiper@8/swiper-bundle.min.css"
  />
{%- endblock css %}

{%- block javascript %}
  {{ super() }}
  {{ webpack["geo-knowledge-hub-front-carousel.js"] }}
  
  <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
  <script>
    const swiper = new Swiper('.swiper', {
    // If we need pagination
    pagination: {
      el: '.swiper-pagination',
    },

    // Navigation arrows
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },

    // And if we need scrollbar
    scrollbar: {
      el: '.swiper-scrollbar',
    },
  });
  </script>

  <script>
    document.querySelector('.latest-additions-opt').addEventListener("click", (e) => {
      e.preventDefault();
      swiper.slideTo(0);
    });

    document.querySelector(".engagement-priorities-opt").addEventListener("click", (e) => {
      e.preventDefault();
      swiper.slideTo(1);
    })
  </script>
{%- endblock javascript %}

{%- block page_header %}
  {%- include "geo_knowledge_hub/base/header_frontpage.html" %}
{%- endblock page_header %}

{%- block first_section %}
  <input 
    id="record-engagements"
    type="hidden" 
    name="record-engagements" 
    value='{{engagement_priority_topics_available | tojson }}'>
  </input>

  <section class="ui padded relaxed centered float-section-buttons">
    <div class="ui compact menu">
      <div data-tooltip="See our latest additions">
        <a class="item latest-additions-opt" >
          <i class="boxes icon"></i>
        </a>
      </div>
      <div data-tooltip="Search resources by engagement priorities">
        <a class="item engagement-priorities-opt">
          <i class="flag icon"></i>
          <div class="floating ui teal label">New</div>
        </a>
      </div>
    </div>
  </section>

  <section class="section-white-bg">
    <div class="swiper">
      <div class="swiper-wrapper">
        <div class="swiper-slide">

         <span class="section-subtitle-content">{{ _("Latest additions") }}</span>
          <div class="ui container">
            <div class="ui padded relaxed centered grid">
              <div class="column">
                <div class="ui centered link cards">
                  {% for item in latest_records %}
                    <a href="/records/{{ item['id'] }}" class="card gkhub-frontpage-cards">
                      <div class="left aligned content">
                        <div class="extra labels-actions ribbon-latest-additions-title">
                          <div class="ui blue ribbon label">
                            {{ item['ui']['publication_date_l10n_medium'] }}
                          </div>
                        </div>
                        <div class="left aligned header"> {{ item['metadata']['title'] }} </div>
                        <div class="meta">
                          {% for creator in item['ui']['creators']['creators'] %}
                            <span>{{ creator['person_or_org']['name'] }};</span>
                          {% endfor %}
                        </div>
                        <div class="description aligned justified">
                          {{ item['ui']['description_stripped'] | truncate(100, true, '...') }}
                        </div>
                      </div>
                    </a>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="swiper-slide">
          <span class="section-subtitle-content">{{ _("Search by engagement priorities") }}</span>
          <div class="ui container">
            <div class="ui padded relaxed centered grid">
              <div class="column">
                <div align="center">
                  <div id="front-engagements"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>
  </section>
  
{%- endblock first_section %}

{%- block second_section %}
{%- endblock second_section %}
